{"componentChunkName":"component---src-templates-post-js","path":"/snake-game-in-javascript/","webpackCompilationHash":"65c611f74b1531f04772","result":{"data":{"markdownRemark":{"html":"<p>Usually when you think of a JavaScript game, you probably imagine something played in the browser, either rendered to the DOM or in an HTML5 canvas element.</p>\n<p>For a recent Node.js project, I wanted to render pixels to a terminal interface instead of a browser. For this, I was going to need to find and learn how to use a terminal UI library like <a href=\"https://en.wikipedia.org/wiki/Curses_(programming_library)\">curses</a>. The most popular one in the JavaScript environment is <a href=\"https://github.com/chjj/blessed\">blessed</a>.</p>\n<p>I thought writing the classic Snake game would be a fun and easy project to get used to blessed, so I wrote <a href=\"https://github.com/taniarascia/snek\">üêç Snek.js</a>.</p>\n<p>You can <a href=\"https://github.com/taniarascia/snek\">check out the source</a>, or download it and play it yourself:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone https://github.com/taniarascia/snek\n<span class=\"token builtin class-name\">cd</span> snek\n<span class=\"token function\">yarn</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">yarn</span> play <span class=\"token comment\"># or: npm install &amp;&amp; npm run play</span></code></pre></div>\n<p>Here's a brief preview gif of the game:</p>\n<p><img src=\"/79ed49adabcad3850a3a45b31ebf834f/snek.gif\" alt=\"Snek.gif\"></p>\n<p>I made the game as I remember it from the old Nokia bricks:</p>\n<ul>\n<li>There's a randomly generated dot</li>\n<li>There's a snake that can go up, down, left, or right</li>\n<li>If the snake eats the dot, it grows and the score goes up by one</li>\n<li>If the snake runs into the wall or itself, the game resets</li>\n</ul>\n<h2 id=\"object-oriented\"><a href=\"#object-oriented\" aria-label=\"object oriented permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Object-Oriented</h2>\n<p>I made extensive use of the ES6 JavaScript <code class=\"language-text\">class</code> keyword, and divided the game into two classes:</p>\n<ul>\n<li><code class=\"language-text\">Game</code>, which would track the state of the snake, dot, and score</li>\n<li><code class=\"language-text\">UserInterface</code>, which would handle all i/o, which means the key input, the screen, and rendering anything to the screen</li>\n</ul>\n<h3 id=\"user-interface\"><a href=\"#user-interface\" aria-label=\"user interface permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>User Interface</h3>\n<p>Blessed uses \"boxes\" to represent elements, so I had a <code class=\"language-text\">gameBox</code> to represent the entire game play area, <code class=\"language-text\">scoreBox</code> to represent a single line where the score would be set and updated, and <code class=\"language-text\">gameOverBox</code> to display a game over modal.</p>\n<p>All the pixels that would be drawn to the screen beyond that - in this case, the dot and each segment of snake - go through the <code class=\"language-text\">draw()</code> method, which is a <code class=\"language-text\">1px</code> x <code class=\"language-text\">1px</code> box.</p>\n<p>Since all key input would be detected through the <code class=\"language-text\">UserInterface</code> class, I had to bind all the handler methods so they could be used through the <code class=\"language-text\">Game</code> class.</p>\n<div class=\"filename\">UserInterface.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">bindHandlers</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">keyPressHandler<span class=\"token punctuation\">,</span> quitHandler<span class=\"token punctuation\">,</span> enterHandler</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>screen<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'keypress'</span><span class=\"token punctuation\">,</span> keyPressHandler<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>screen<span class=\"token punctuation\">.</span><span class=\"token function\">key</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'escape'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'q'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'C-c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> quitHandler<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>screen<span class=\"token punctuation\">.</span><span class=\"token function\">key</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'enter'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> enterHandler<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"filename\">Game.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span><span class=\"token function\">bindHandlers</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">changeDirection</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">quit</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"game\"><a href=\"#game\" aria-label=\"game permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Game</h3>\n<p>The <code class=\"language-text\">Game</code> tracked the snake, the dot, and the score.</p>\n<p>The snake is an array of x/y coordinates that correspond to pixels on the screen. The snake moves in a direction based on the key input (arrow keys and WASD supported!). To move, the last item in the array (the tail) is removed, and a new item (the head) is added to the beginning. If the snake eats a dot, the last item isn't removed, and the snake grows.</p>\n<p>A new dot is generated randomly after being eaten. Dots wont generate on an existing snake segment.</p>\n<p>The game ends if the snake collides with the edges of the terminal screen (the wall), or with its own tail, and the game over modal is displayed.</p>\n<p>Pressing enter will start a new game by calling the <code class=\"language-text\">start</code> method, which resets the game state and starts a timer if one doesn't exist.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timer<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">reset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timer <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">tick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Every <code class=\"language-text\">50</code>ms, <code class=\"language-text\">tick</code> is called, which is the game loop. The timer will restart if there's a game over. Otherwise, each tick will clear the screen, draw a dot, move the snake, draw the snake, and render everything to the UI.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">tick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">gameOver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">showGameOverScreen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timer<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timer <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n\n    <span class=\"token keyword\">return</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">drawDot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">moveSnake</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">drawSnake</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"conclusion\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p>Again, you can view the source on GitHub at <a href=\"https://github.com/taniarascia/snek\">üêç Snek.js</a>.</p>\n<p>I learned a lot writing and refactoring this over the past few days. I encountered plenty of bugs in my first iteration, such as the snake being able to collide into all but the last tail segment, and a major issue where the blessed boxes weren't being garbage collected, and the game got slower and slower as it became less efficient and more intensive to run.</p>\n<p><a href=\"https://sergeev.io\">vsergeev</a> wrote a very clean and much more advanced and extensible <a href=\"https://github.com/vsergeev/snake.ts\">Typescript implementation of Snake</a>, with a mini-game engine and AI monster entity. Studying this helped me find and fix some of the bugs in my first iteration.</p>","timeToRead":4,"excerpt":"Usually when you think of a JavaScript game, you probably imagine something played in the browser, either rendered to the DOM or in an HTML‚Ä¶","frontmatter":{"title":"Writing a Snake Game for the Terminal in Object-Oriented JavaScript (Node.js)","thumbnail":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAEvElEQVQ4y3VTe0xTZxS/wIxbplOjohsReVZLUacGlGcptJTSe29720KBIi9ZeHS8YQJC2ShSwJY3IqBQRIiCEHVOZbLpJkKdY4+wODMDarbE7PnH4rJpe7+z9vLKzHqS755zv5zz+875nXMwbFEez/6BvSSOgTphME8vTMMbqFSyRLXTdimGTZgkJI9xIHUK7H9lfHKE0QCAjZt6s3MaswzKgRhT6Xk1FN98B6jbAiBGImnSQBXY/IhRgSNZqLIP+PG9IQebNv/5eMvJiWozfoUPmodq6DiTj4yfvm+h7vLM4pmDILkUBUSF8gADaqAcMXuibFIxOi9e+wY5IJ6PNgWA7E64OXs8HuVPJqPC79KQ7A7vH+rLcCDbJPUMYK/YyW6GuEHCZIhnqTyIMQFE3zsIxFTwi7wHSXD29zboMOktMWNRz6hveEB2SFoYwAGRfcCI5jhsDhZscRc+nGVKgvZHOjg922opuVD0V3pPKiTcEpnJG3yQVCtxBrBJ6mS3ZMBWYXsasxl7biPHVZcbW3DodHZSaGmkOsuY8WvBdCqS3AsD4gQxZvMRgbsDWR1jvyk/u3oz+ic31tpf3Lz2LN2XjhZN6+4fAeKLEBD3iublSZmbmexq5U5krQIj9JT98Znbwf7Pf95gzoWuJw1AToWAaDDiR5WqaOvLMeJG0slKAWMT9ZT1oUXghuQwRmcaEl+xadlxZWzPg2ZIm5E+jxwLAUm94prYQKbjx6VZ0rpYcVJZrvsS6DYr94riwwugdbKVdEmN0mHJSfNh+VdNTzTAvbjXIurj08KrgSD+JBRE14Ih4kIAhBkD/hZ28aetDyUtxcjKk1dSl5THY4eBx9j8muhjBlMtqGfi6WDjfpR8NgY0U7l0232t+eQjnaVprhIVfp0KookAEF6ycttMtNriws/7O4j15CIXHTgz9ZQ+5j3+aAjU362iE2/iKKB3DySfTITMwRT07kgaKr6sRvWTVejK00HUPd9gDhxj04L+UJBXJocyJetkjtaPnAGTVMWFk6cIcO/ejPKvZtI5nx8CdpcL4rYGot3lHPAocIHt+VvAu8gD5V3KRHm3U2Bvn4eZ2+cP1sUwrZQLngx3km7yunRMBK4nNrzg6L2gZrIM+fewYGfrm7CvnQV+rRzwa/GF/c1s8G3ZDt5NzojTsg0FtfgDv59Ly2sTlscN46xXvS4fxp+qr6bB2/3e9NpaDO3T+yJFLwE+WjfkXb0VeWg3W88m8NQ6I5b2LfCt8UR+1fssfkYOEg5zLTFH0nYsA/KwqtXEUNS8frYKqD6S3ml0QWt0GFqvedXC1npZdmnY9K6jbJpTsYP2qWRZfKpYZk4dy7zL6A5Rt4JA2ik9xfTih/0OmPgcn+FQ0BTZrp5NhIqJkufKfoUF/4gLgosHYHefG7i3bwTX5g3g0rgO3Do3AWfIFQIu+kLUubBn0nZ5nT92gsEgy+MdbGvEcBibn+Es6Iz4lrrOh4TLUlCcIV9QnZIbom7heHhP6MOwU0FPeD1B30d0cz8je/HTira4TGvMtuVeFCcuzzFGfrAw1OkZR9dEVuMJYTX8lOBC4fIuGliTq+v23nitf91vq15eP2I00pEoi1uw9TLsX3KtGJdTigmhAAAAAElFTkSuQmCC","width":150,"height":150,"src":"/static/4fecbe96ed0042b3a5f165d9a47a5d3d/4148e/snake.png","srcSet":"/static/4fecbe96ed0042b3a5f165d9a47a5d3d/4148e/snake.png 1x,\n/static/4fecbe96ed0042b3a5f165d9a47a5d3d/de03e/snake.png 1.5x"}}},"slug":"snake-game-in-javascript","date":"2019-04-09T00:00:00.000Z","categories":["Code"],"tags":["javascript","terminal","node"],"template":"post"},"fields":{"slug":"/snake-game-in-javascript/","date":"2019-04-09T00:00:00.000Z"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/snake-game-in-javascript/"}}}